SEGMENT TREE.
Input size should be 2^k. (k=0, 1, 2 ...)
